<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Starving Artist Prototype</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cardo:wght@400;700&family=Cinzel:wght@600;700&display=swap">
  <style>
    body {
  font-family: 'Cardo', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at top, #181116 0, #060608 55%, #020203 100%);
  color: #eee;
  margin: 0;
  padding: 0;
}

    header {
  padding: 14px 20px;
  background: linear-gradient(to bottom, #0d0c0f, #151319);
  border-bottom: 1px solid #272333;
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.7);
}

header h1 {
  margin: 0 0 4px;
  font-size: 26px;
  font-family: 'Cinzel', 'Cardo', serif;
  letter-spacing: 0.18em;
  text-transform: uppercase;
}


    header .meta {
      font-size: 13px;
      color: #bbb;
      display: flex;
      gap: 16px;
    }

    /* Board container: feels like a physical board on a table */
main.app {
  display: grid;
  grid-template-columns: 2fr minmax(260px, 1fr);
  gap: 16px;
  padding: 16px 20px 20px;
  box-sizing: border-box;
  max-width: 1100px;
  margin: 20px auto 32px;
  background: radial-gradient(circle at top, #2c1b11 0, #1c1410 40%, #141010 100%);
  border-radius: 16px;
  box-shadow: 0 18px 50px rgba(0, 0, 0, 0.75);
  border: 1px solid #3b2a18;
}


    .panel {
      border: 1px solid #333;
      border-radius: 8px;
      padding: 12px;
      background: #181818;
    }

    h2, h3 {
      margin: 0 0 8px;
    }

    .board-column {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .player-column {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .stage-band {
  border-radius: 12px;
  padding: 10px 12px 12px;
  border: 1px solid rgba(255, 255, 255, 0.05);
  background: rgba(0, 0, 0, 0.45);
  box-shadow:
    0 8px 14px rgba(0, 0, 0, 0.7),
    inset 0 0 0 1px rgba(0, 0, 0, 0.45);
}

.stage-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.stage-title {
  font-size: 18px;
  font-weight: 600;
  font-family: 'Cinzel', 'Cardo', serif;
  letter-spacing: 0.16em;
  text-transform: uppercase;
}

.stage-subtitle {
  font-size: 12px;
  color: #d6cbbd;
  margin-top: 2px;
}

/* Stage colors – subtle tint so they still feel unified on one board */
.stage-home {
  background:
    linear-gradient(to bottom right, rgba(93, 70, 46, 0.7), rgba(46, 31, 23, 0.9));
}

.stage-dreamer {
  background:
    linear-gradient(to bottom right, rgba(38, 69, 93, 0.7), rgba(18, 37, 54, 0.9));
}

.stage-amateur {
  background:
    linear-gradient(to bottom right, rgba(94, 89, 45, 0.7), rgba(49, 43, 22, 0.9));
}

.stage-pro {
  background:
    linear-gradient(to bottom right, rgba(46, 96, 70, 0.7), rgba(20, 53, 36, 0.9));
}

    /* Arrows between stages (visual ladder up the board) */

.stage-arrow {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin: 6px 0 10px;
  color: #d6cbbd;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.14em;
  opacity: 0.9;
}

.stage-arrow-icon {
  font-size: 18px;
  line-height: 1;
}

.stage-arrow-label {
  border-radius: 999px;
  padding: 3px 10px 4px;
  border: 1px solid rgba(255, 255, 255, 0.12);
  background: radial-gradient(circle at top, #29211c 0, #181310 70%);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
}

.stage-body {
  font-size: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

    .stage-actions {
  margin-top: 4px;
}


    .stage-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    /* Stage colors */

    .stage-home {
      background: #3b2a1a;
    }

    .stage-dreamer {
      background: #193245;
    }

    .stage-amateur {
      background: #3b361a;
    }

    .stage-pro {
      background: #1c3b2a;
    }

    /* Tracks */

    .home-track {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .track-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .track-row-label {
      min-width: 70px;
      font-size: 11px;
      color: #ddd;
    }

    .track-row-cells {
      display: flex;
      gap: 4px;
    }

    .track-cell {
      width: 18px;
      height: 18px;
      border-radius: 4px;
      border: 1px solid #555;
      background: rgba(0, 0, 0, 0.2);
    }

    .track-cell.filled {
      background: #f5c842;
      border-color: #f9e58b;
    }

    .minorworks-track {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .track-steps {
      display: flex;
      gap: 4px;
      align-items: flex-end;
    }

    .track-step {
      min-width: 32px;
      border-radius: 4px;
      padding: 2px;
      border: 1px solid #444;
      background: rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
    }

    .track-step-label {
      font-size: 10px;
      color: #ccc;
    }

    .track-step-tokens {
      display: flex;
      flex-wrap: wrap;
      gap: 2px;
      justify-content: center;
    }

    .player-token {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      border: 1px solid #000;
      background: #888;
    }

    .job-market {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .job-card {
      border-radius: 6px;
      border: 1px solid #555;
      background: rgba(0, 0, 0, 0.3);
      padding: 4px 6px;
      min-width: 110px;
      font-size: 11px;
    }

    .job-card-title {
      font-weight: 600;
      margin-bottom: 2px;
    }

    .job-card-effects {
      color: #ccc;
    }

    .job-card-empty {
      font-size: 11px;
      color: #ccc;
      font-style: italic;
    }

    /* Player panel */

    .player-panel h2 {
      margin-bottom: 4px;
    }

    .player-header {
      margin-bottom: 8px;
      font-size: 13px;
    }

    .player-name {
      font-weight: 600;
      font-size: 14px;
    }

    .player-artpath {
      font-size: 12px;
      color: #bbb;
    }

    .badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 11px;
      border: 1px solid #555;
      margin-left: 4px;
    }

    .badge.pro { border-color: #f5c842; color: #f5c842; }
    .badge.amateur { border-color: #42c0f5; color: #42c0f5; }
    .badge.dreamer { border-color: #9b59b6; color: #d1a6ff; }
    .badge.home { border-color: #7f8c8d; color: #bdc3c7; }

    .section-title {
  margin-top: 10px;
  font-size: 11px;
  text-transform: uppercase;
  color: #c2b59e;
  letter-spacing: 0.14em;
}

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 4px 12px;
      font-size: 13px;
      margin-top: 4px;
    }

    .label {
  color: #a89f90;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.12em;
}

    .value {
  font-weight: 600;
  font-size: 14px;
}

    .player-progress {
      font-size: 12px;
      margin-top: 4px;
    }

    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: 6px;
      margin-top: 4px;
    }

    button {
  background: radial-gradient(circle at top, #3b3330 0, #262021 60%, #1b1516 100%);
  color: #f4efe6;
  border-radius: 10px;
  border: 1px solid #5b4b46;
  padding: 6px 9px;
  font-size: 12px;
  cursor: pointer;
  box-shadow:
    0 2px 3px rgba(0, 0, 0, 0.65),
    inset 0 0 0 1px rgba(0, 0, 0, 0.4);
  text-transform: none;
}

button:hover {
  background: radial-gradient(circle at top, #4b423f 0, #302629 60%, #1f1719 100%);
}

button:disabled {
  opacity: 0.45;
  cursor: default;
  box-shadow: none;
}


    button:hover { background: #444; }

    button:disabled {
      opacity: 0.4;
      cursor: default;
    }

    select {
      background: #222;
      color: #eee;
      border-radius: 4px;
      border: 1px solid #444;
      padding: 4px;
      font-size: 13px;
    }

    .log {
      font-family: "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      max-height: 200px;
      overflow-y: auto;
      background: #101010;
      border-radius: 6px;
      padding: 6px;
      border: 1px solid #333;
      white-space: pre-wrap;
    }

    .game-over {
      margin-top: 6px;
      padding: 6px 8px;
      border-radius: 6px;
      background: #3e1b1b;
      border: 1px solid #a33;
      color: #fdd;
      font-size: 13px;
    }

    pre {
      margin: 0;
      font-family: "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      white-space: pre-wrap;
    }

        /* Card popup overlay */
    .card-overlay {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.75);
      z-index: 1000;
    }
    .card-overlay.visible {
      display: flex;
    }
    .card-modal {
      background: #181818;
      border-radius: 10px;
      border: 1px solid #555;
      padding: 16px 18px;
      max-width: 420px;
      width: calc(100% - 40px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
    }
    .card-modal h2 {
      margin: 0 0 4px;
      font-size: 18px;
    }
    .card-modal h3 {
      margin: 0 0 8px;
      font-size: 16px;
      font-weight: 600;
    }
    .card-modal pre {
      margin: 0 0 12px;
      font-size: 13px;
      white-space: pre-wrap;
    }
    .card-modal button {
      width: 100%;
      margin-top: 4px;
    }

        /* Time bar (for Time this turn) */
    .time-bar {
      display: inline-flex;
      gap: 4px;
      margin-left: 8px;
      vertical-align: middle;
    }
    .time-segment {
      width: 12px;
      height: 12px;
      border-radius: 3px;
      border: 1px solid #555;
      background: #222;
      box-sizing: border-box;
    }
    .time-segment.filled {
      background: #2ecc71;
      border-color: #2ecc71;
    }

    /* Dice roll popup */
    .dice-overlay {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.75);
      z-index: 1001;
    }
    .dice-overlay.visible {
      display: flex;
    }
    .dice-modal {
      background: #181818;
      border-radius: 10px;
      border: 1px solid #555;
      padding: 16px 20px;
      max-width: 260px;
      width: calc(100% - 40px);
      text-align: center;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
    }
    .dice-modal h2 {
      margin: 0 0 8px;
      font-size: 18px;
    }
    .dice-face {
      font-size: 48px;
      margin: 12px 0 16px;
    }
    .dice-face.rolling {
      animation: dice-wiggle 0.15s linear infinite;
    }
    @keyframes dice-wiggle {
      0%   { transform: translateX(0); }
      25%  { transform: translateX(-2px); }
      50%  { transform: translateX(2px); }
      75%  { transform: translateX(-1px); }
      100% { transform: translateX(0); }
    }

  </style>
</head>
<body>
  <header>
    <h1>Starving Artist</h1>
    <div class="meta">
      <div>Turn: <span id="turn">1</span></div>
      <div>Art Path: <span id="artPath"></span></div>
    </div>
  </header>

  <main class="app">
    <!-- LEFT: BOARD COLUMN -->
    <div class="board-column">
  <!-- Pro Stage (top of the ladder) -->
  <section class="stage-band stage-pro">
    <div class="stage-header">
      <div>
        <div class="stage-title">Pro</div>
        <div class="stage-subtitle" id="proPromotion"></div>
      </div>
      <div class="stage-players">
        <span class="stage-players-label">Players here:</span>
        <div id="proStagePlayers"></div>
      </div>
    </div>
    <div class="stage-body">
      <div class="stage-row">
        <div>
          <div class="label">Masterwork Track</div>
          <div id="masterworkTrack"></div>
        </div>
        <div>
          <button id="drawProCardBtn" type="button">Draw Pro Card</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Arrow: Amateur → Pro -->
  <div class="stage-arrow">
    <span class="stage-arrow-icon">↑</span>
    <span class="stage-arrow-label">Advance to Pro</span>
  </div>

  <!-- Amateur Stage -->
  <section class="stage-band stage-amateur">
    <div class="stage-header">
      <div>
        <div class="stage-title">Amateur</div>
        <div class="stage-subtitle" id="amateurPromotion"></div>
      </div>
      <div class="stage-players">
        <span class="stage-players-label">Players here:</span>
        <div id="amateurStagePlayers"></div>
      </div>
    </div>
    <div class="stage-body">
      <div class="stage-row">
        <div class="job-market">
          <div class="label" style="width:100%;">Available Jobs</div>
          <div id="jobMarket" style="width:100%; display:flex; flex-wrap:wrap; gap:6px;"></div>
        </div>
        <div>
          <button id="takeProfDevBtn" type="button">Draw Prof Dev Card</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Arrow: Dreamer → Amateur -->
  <div class="stage-arrow">
    <span class="stage-arrow-icon">↑</span>
    <span class="stage-arrow-label">Advance to Amateur</span>
  </div>

  <!-- Dreamer Stage -->
  <section class="stage-band stage-dreamer">
    <div class="stage-header">
      <div>
        <div class="stage-title">Dreamer</div>
        <div class="stage-subtitle" id="dreamerPromotion"></div>
      </div>
      <div class="stage-players">
        <span class="stage-players-label">Players here:</span>
        <div id="dreamerStagePlayers"></div>
      </div>
    </div>
    <div class="stage-body">
      <div class="stage-row">
        <div class="minorworks-track">
          <div class="label">Minor Works Ladder</div>
          <div id="minorWorksTrack"></div>
        </div>
        <div>
          <button id="attendSocialBtn" type="button">Draw Social Card</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Arrow: Home → Dreamer -->
  <div class="stage-arrow">
    <span class="stage-arrow-icon">↑</span>
    <span class="stage-arrow-label">Advance to Dreamer</span>
  </div>

  <!-- Home Stage (bottom of the ladder) -->
  <section class="stage-band stage-home">
    <div class="stage-header">
      <div>
        <div class="stage-title">Home</div>
        <div class="stage-subtitle" id="homePromotion"></div>
      </div>
      <div class="stage-players">
        <span class="stage-players-label">Players here:</span>
        <div id="homeStagePlayers"></div>
      </div>
    </div>
    <div class="stage-body">
      <div class="stage-row">
        <div class="home-track">
          <div class="label">Home Path (3 successes)</div>
          <div id="homePathTrack"></div>
        </div>
        <div>
          <button id="drawHomeBtn" type="button">Draw Home Card</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Game over banner (board-level) -->
  <section id="gameOverPanel" class="panel">
    <div id="gameOverBanner" class="game-over" style="display:none;"></div>
  </section>
</div>


    <!-- RIGHT: PLAYER COLUMN -->
    <div class="player-column">
      <section id="playerPanel" class="panel player-panel">
        <h2>Active Player</h2>
        <div class="player-header">
          <div class="player-name" id="playerName">Player 1</div>
          <div class="player-artpath">
            <span id="playerArtPath">author</span>
            <span id="stageBadge" class="badge home">Home</span>
          </div>
          <div style="font-size:12px; color:#ccc;">
            Stage: <span id="stageName">Home</span>
          </div>
        </div>

        <!-- Stats -->
        <div class="section-title">Stats</div>
        <div class="stats-grid">
          <div>
            <div class="label">Money</div>
            <div class="value" id="statMoney">0</div>
          </div>
          <div>
            <div class="label">Food</div>
            <div class="value" id="statFood">0</div>
          </div>
          <div>
            <div class="label">Inspiration</div>
            <div class="value" id="statInspiration">0</div>
          </div>
          <div>
            <div class="label">Craft</div>
            <div class="value" id="statCraft">0</div>
          </div>
                    <div>
            <div class="label">Time</div>
            <div class="value">
              <span id="statTime">0</span>
              <div id="timeBar" class="time-bar">
                <div class="time-segment"></div>
                <div class="time-segment"></div>
                <div class="time-segment"></div>
                <div class="time-segment"></div>
                <div class="time-segment"></div>
                <div class="time-segment"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Progress summary -->
        <div class="player-progress">
          Minor Works: <span id="minorWorksCount">0</span><br />
          Portfolio: <span id="portfolioStatus">Not yet</span><br />
          Masterwork: <span id="masterworkProgress">0 / 0</span>
        </div>

        <!-- Job / Culture -->
        <div class="player-job-section">
          <div class="section-title">Job & Culture</div>
          <div style="font-size:12px;">
            Job: <span id="jobInfo">No job (or lost job)</span><br />
            Culture: <span id="cultureInfo">None (not implemented yet)</span>
          </div>
        </div>


        <!-- Minor works list -->
        <div class="section-title">Minor Works (this player)</div>
        <pre id="minorWorksList">None yet.</pre>

        <!-- Current / recent card info -->
        <div class="section-title">Recent Events</div>
        <pre id="cardInfo">No recent events yet.</pre>

                <!-- Actions -->
        <div class="section-title">Actions</div>

        <!-- Turn controls (always visible) -->
        <div class="label" style="margin-top:4px;">Turn</div>
        <div class="controls-grid">
          <button id="rollTimeBtn" type="button">Roll Time</button>
          <button id="endTurnBtn" type="button">End Turn</button>
        </div>

        <!-- Home-only actions -->
        <div class="stage-actions stage-home-only">
          <div class="label" style="margin-top:8px;">Home</div>
          <div class="controls-grid">
            <button id="attemptLeaveHomeBtn" type="button">Try to Leave Home</button>
          </div>
        </div>

        <!-- Dreamer-only actions -->
        <div class="stage-actions stage-dreamer-only">
          <div class="label" style="margin-top:8px;">Dreamer</div>
          <div class="controls-grid">
            <button id="skipSocialBtn" type="button">Skip Social Event</button>
            <button id="attemptAdvanceDreamerBtn" type="button">Try to Advance</button>
          </div>
        </div>

        <!-- Amateur-only actions -->
        <div class="stage-actions stage-amateur-only">
          <div class="label" style="margin-top:8px;">Amateur</div>
          <div class="controls-grid">
            <select id="jobSelect">
              <option value="">Choose a Job…</option>
            </select>
            <button id="chooseJobBtn" type="button">Choose Job</button>
            <button id="goToWorkBtn" type="button">Go To Work</button>
            <button id="startMinorWorkBtn" type="button">Start Minor Work</button>
            <button id="compilePortfolioBtn" type="button">Compile Portfolio</button>
            <button id="attemptAdvanceProBtn" type="button">Try to Go Pro</button>
          </div>
        </div>

        <!-- Pro-only actions -->
        <div class="stage-actions stage-pro-only">
          <div class="label" style="margin-top:8px;">Pro</div>
          <div class="controls-grid">
            <button id="workMasterworkBtn" type="button">Work on Masterwork</button>
            <button id="proMaintenanceBtn" type="button">Maintenance Check</button>
          </div>
        </div>

      </section>

      <!-- Debug panel -->
      <section id="debugPanel" class="panel">
        <h2 style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
          <span>Debug</span>
          <button id="toggleDebug" type="button">Toggle Debug</button>
        </h2>
        <pre id="debugLog" class="log" style="display:none;">{}</pre>
      </section>
    </div>
  </main>

    <!-- Card popup overlay -->
  <div id="cardOverlay" class="card-overlay">
    <div class="card-modal">
      <h2 id="cardOverlayTitle">Card</h2>
      <h3 id="cardOverlayName"></h3>
      <pre id="cardOverlayBody"></pre>
      <button id="cardOverlayClose" type="button">OK</button>
    </div>
  </div>

  <!-- Dice roll overlay -->
  <div id="diceOverlay" class="dice-overlay">
    <div class="dice-modal">
      <h2>Time Roll</h2>
      <div id="diceFace" class="dice-face">-</div>
      <button id="diceOkButton" type="button">OK</button>
    </div>
  </div>
  
  <!-- keep this at the very end -->
  <script type="module" src="./src/main.js"></script>
</body>
</html>
